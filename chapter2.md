# 第2章：可编程时代 (2000-2005)

> 从固定功能管线到可编程着色器的革命性跨越

## 章节概览

2000年到2005年是GPU发展史上的关键转折期。这五年间，NVIDIA不仅完成了从固定功能渲染管线到完全可编程架构的技术革命，更通过一系列战略收购和产品创新，奠定了其在图形处理领域的统治地位。本章将深入剖析这个时代的技术突破、商业决策以及与竞争对手的激烈较量。

## 时代背景

### 千禧年的技术浪潮

```
2000年计算机图形产业格局
┌─────────────────────────────────────┐
│         市场主要玩家                   │
├─────────────────────────────────────┤
│ NVIDIA  │ GeForce2 系列               │
│ ATI     │ Radeon 系列                 │
│ 3dfx    │ Voodoo 4/5 (末代产品)        │
│ Intel   │ 集成显卡起步                 │
│ Matrox  │ 专业2D/视频市场              │
└─────────────────────────────────────┘
```

### 技术演进压力

- **游戏引擎需求爆发**：id Software的Doom 3、Valve的Half-Life 2推动硬件革新
- **DirectX演进**：微软DirectX 8.0/9.0定义可编程管线标准
- **OpenGL扩展竞赛**：各厂商通过扩展推动标准演进
- **主机世代更替**：索尼PS2、微软Xbox、任天堂GameCube的技术竞争

## 1. 收购3dfx：清除最强对手 (2000年12月)

### 1.1 收购背景与动机

#### 3dfx的衰落轨迹
```
3dfx关键失误时间线
1998 ├── 收购STB，自产显卡，得罪OEM合作伙伴
1999 ├── Voodoo3延迟，错过32位色彩时代
2000 ├── Voodoo 4/5失败，VSA-100架构缺陷
2000.12 ├── 破产，核心资产被NVIDIA收购
```

#### NVIDIA的战略考量

**技术资产价值**：
- **SLI技术专利**：Scan-Line Interleave多卡并行渲染
- **Glide API生态**：大量游戏优化资产
- **反锯齿技术**：T-Buffer和FSAA专利组合
- **工程师团队**：Gary Tarolli等核心架构师

**商业价值分析**：
- 收购价格：仅7000万美元现金+100万股股票
- 专利价值：超过100项图形相关专利
- 市场份额：立即获得3dfx 15%的市场份额
- 品牌资产：Voodoo品牌在玩家中的影响力

### 1.2 技术整合与传承

#### SLI技术的重生之路
```
SLI技术演进
3dfx VSA-100 (2000)
├── 芯片级SLI
├── 最多4芯片并联
└── 带宽瓶颈严重

NVIDIA SLI 2.0 (2004)
├── PCIe接口
├── 智能负载均衡
├── AFR(交替帧渲染)
└── SFR(分割帧渲染)
```

## 2. GeForce 3革命：可编程着色器时代来临 (2001年2月)

### 2.1 nfiniteFX引擎架构详解

#### 核心创新点

**顶点着色器(Vertex Shader)**：
```
固定管线 vs 可编程管线对比
┌──────────────────┬──────────────────┐
│   固定功能T&L     │  可编程顶点着色器   │
├──────────────────┼──────────────────┤
│ 预定义变换        │ 自定义顶点程序     │
│ 固定光照模型      │ 可编程光照算法     │
│ 有限特效         │ 无限创意空间       │
│ 硬件效率高       │ 灵活性极强         │
└──────────────────┴──────────────────┘
```

**像素着色器(Pixel Shader)**：
- DirectX 8.0 Pixel Shader 1.1支持
- 每像素4个纹理查找
- 8个combiner阶段
- 寄存器组合器架构

#### 技术规格深度剖析

| 参数 | GeForce 2 Ultra | GeForce 3 Ti 500 | 提升幅度 |
|------|----------------|------------------|----------|
| 晶体管数 | 2500万 | 5700万 | 2.3倍 |
| 制程工艺 | 180nm | 150nm | - |
| 核心频率 | 250 MHz | 240 MHz | -4% |
| 显存带宽 | 7.36 GB/s | 8.0 GB/s | 8.7% |
| 像素填充率 | 1.0 Gpixels/s | 0.96 Gpixels/s | -4% |
| 顶点处理 | 固定T&L | 可编程VS | 革命性 |
| 像素处理 | 固定管线 | 可编程PS | 革命性 |

### 2.2 Lightspeed内存架构

#### 创新内存技术
- **Crossbar内存控制器**：4个独立64位控制器
- **Z-Cull技术**：早期深度剔除，节省50%带宽
- **无损Z压缩**：4:1压缩比
- **快速Z清除**：硬件加速深度缓冲清除

### 2.3 对游戏产业的深远影响

#### 代表性技术演示
- **Chameleon Demo**：可编程材质展示
- **Zoltar Demo**：实时角色动画
- **Nature Demo**：程序化自然场景

## 3. Xbox合作：进军主机市场 (2001年11月)

### 3.1 合作谈判内幕

#### 微软的选择过程
```
Xbox GPU竞标过程 (2000年)
候选方案：
1. Intel - 集成方案，性能不足
2. ATI - R200架构，价格过高
3. NVIDIA - NV2A定制方案，性价比最优
4. 3dfx - 财务危机，无法承接
```

### 3.2 NV2A定制芯片详解

#### 技术规格对比
| 特性 | NV2A (Xbox) | GeForce 3 Ti | 优化说明 |
|------|-------------|--------------|----------|
| 顶点着色器 | 2个 | 1个 | 双倍几何性能 |
| 像素管线 | 4条 | 4条 | 保持一致 |
| 内存接口 | 统一内存架构 | 独立显存 | 成本优化 |
| 音频DSP | 集成 | 无 | 额外功能 |

#### 架构创新
```
Xbox统一内存架构 (UMA)
┌─────────────────────────────┐
│         系统RAM              │
│         64MB DDR             │
│    ┌──────────┬────────┐    │
│    │  CPU使用  │ GPU使用 │    │
│    │  动态分配  │ 动态分配 │    │
│    └──────────┴────────┘    │
│      6.4GB/s 带宽            │
└─────────────────────────────┘
```

### 3.3 商业影响与后续纠纷

#### 财务条款争议
- **初始协议**：每片芯片固定价格
- **成本下降问题**：制程改进后NVIDIA利润被压缩
- **仲裁结果**：2003年微软支付额外补偿

## 4. CineFX架构：追求电影级画质 (2003年)

### 4.1 GeForce FX系列的野心与挫折

#### NV30架构深度分析

**技术突破**：
- **32位浮点精度**：FP32全流水线
- **超长着色程序**：1024条指令
- **第二代顶点着色器**：VS 2.0+规范
- **高级像素着色器**：PS 2.0+扩展

**致命缺陷**：
```
GeForce FX 5800 Ultra问题分析
┌────────────────────────────────┐
│ 设计缺陷         │ 实际影响        │
├────────────────────────────────┤
│ 0.13μm工艺问题   │ 功耗失控        │
│ 500MHz高频策略   │ 发热严重        │
│ FX Flow散热器    │ 噪音如吹风机     │
│ 128位内存带宽    │ 性能瓶颈        │
│ DX9性能低下      │ 输给ATI 9700    │
└────────────────────────────────┘
```

### 4.2 与ATI Radeon 9700的正面对决

#### 架构对比分析

| 特性 | GeForce FX 5800 | Radeon 9700 Pro |
|------|-----------------|-----------------|
| 制程 | 130nm | 150nm |
| 晶体管 | 1.25亿 | 1.07亿 |
| 核心频率 | 500 MHz | 325 MHz |
| 内存位宽 | 128-bit | 256-bit |
| 内存带宽 | 16 GB/s | 19.8 GB/s |
| 像素着色器 | 2.0+ | 2.0 |
| DirectX 9性能 | 弱 | 强 |

### 4.3 技术遗产与经验教训

#### 失败中的创新
- **着色器编译器**：Cg语言基础
- **浮点精度研究**：为CUDA铺路
- **散热设计教训**：影响后续所有产品

## 5. SLI技术复活：多GPU并行的新纪元 (2004年6月)

### 5.1 从3dfx SLI到NVIDIA SLI

#### 技术演进对比
```
技术代际对比
3dfx SLI (1998)          NVIDIA SLI (2004)
├── PCI总线              ├── PCIe x16
├── 扫描线交错           ├── AFR/SFR模式
├── 2卡最大              ├── 2-4卡扩展
├── 驱动支持差           ├── 完善驱动
└── 游戏兼容少           └── 广泛支持
```

### 5.2 SLI 2.0技术架构

#### 渲染模式详解

**AFR (Alternate Frame Rendering)**：
```
帧交替渲染模式
GPU 0: [Frame 1] → [Frame 3] → [Frame 5]
GPU 1: [Frame 2] → [Frame 4] → [Frame 6]
优点：负载均衡好
缺点：帧延迟增加
```

**SFR (Split Frame Rendering)**：
```
帧分割渲染模式
┌──────────────┐
│   GPU 0      │ 上半部分
├──────────────┤
│   GPU 1      │ 下半部分
└──────────────┘
优点：延迟低
缺点：负载不均
```

### 5.3 市场影响与竞争响应

#### 高端市场重新定义
- **6800 Ultra SLI**：性能提升60-90%
- **价格门槛**：双卡配置超过$1000
- **电源需求**：系统功耗超过400W
- **主板生态**：nForce4 SLI芯片组

## 6. 竞争格局：与ATI的技术竞赛

### 6.1 2000-2005年市场份额变化

```
GPU市场份额演变
年份    NVIDIA   ATI     Intel   其他
2000    25%      28%     30%     17%
2001    31%      27%     28%     14%
2002    33%      24%     32%     11%
2003    36%      25%     31%     8%
2004    39%      24%     32%     5%
2005    42%      23%     31%     4%
```

### 6.2 技术路线分歧

#### 设计理念对比

**NVIDIA策略**：
- 追求可编程性
- 软件生态优先
- 统一架构探索
- 开发者工具投入

**ATI策略**：
- 硬件效率优先
- 成本控制
- 传统架构优化
- OEM关系维护

### 6.3 关键产品对决

#### 各代产品性能对比
```
性能指数对比 (以GeForce4 Ti 4600为100)
产品             性能指数   发布时间
GeForce4 Ti 4600   100     2002.02
Radeon 9700 Pro    145     2002.08
GeForce FX 5900    140     2003.05
Radeon 9800 XT     165     2003.09
GeForce 6800 GT    220     2004.04
Radeon X800 XT     235     2004.05
GeForce 6800 Ultra 250     2004.06
GeForce 7800 GTX   320     2005.06
```

## 7. 技术生态建设

### 7.1 Cg着色语言

#### 语言设计目标
- **跨平台兼容**：支持DirectX和OpenGL
- **C语言风格**：降低学习曲线
- **编译器优化**：自动生成优化代码
- **Profile系统**：适配不同硬件代

#### 示例代码对比
```hlsl
// Cg顶点着色器示例
void main(float4 position : POSITION,
          float3 normal : NORMAL,
          out float4 oPosition : POSITION,
          out float4 color : COLOR,
          uniform float4x4 mvpMatrix,
          uniform float3 lightDir)
{
    oPosition = mul(mvpMatrix, position);
    float intensity = dot(normal, lightDir);
    color = float4(intensity, intensity, intensity, 1);
}
```

### 7.2 开发者计划

#### Developer Relations投入
- **技术支持团队**：50+工程师
- **游戏优化计划**："The Way It's Meant to Be Played"
- **开发者大会**：年度技术峰会
- **SDK更新**：季度工具包发布

### 7.3 驱动程序创新

#### ForceWare统一驱动架构
```
驱动架构分层
┌──────────────────────────┐
│     应用程序层            │
├──────────────────────────┤
│   Direct3D / OpenGL       │
├──────────────────────────┤
│   ForceWare统一驱动        │
├──────────────────────────┤
│   硬件抽象层(HAL)         │
├──────────────────────────┤
│   GPU硬件                 │
└──────────────────────────┘
```

## 8. 制程工艺挑战

### 8.1 130nm转型困境

#### 工艺节点对比
| 节点 | 代表产品 | 晶体管密度 | 功耗密度 | 良率问题 |
|------|---------|-----------|---------|---------|
| 150nm | GeForce 3 | 1x | 1x | 稳定 |
| 130nm | GeForce FX | 1.8x | 2.2x | 严重 |
| 110nm | GeForce 6800 | 2.5x | 1.9x | 改善 |

### 8.2 散热设计演进

```
散热方案演变
2001: 单槽被动散热 → 主动风扇
2003: 双槽FX Flow → 噪音问题
2004: 优化双槽 → 热管技术
2005: 液冷方案 → 高端市场
```

## 9. 财务表现与商业策略

### 9.1 营收增长轨迹

```
年度营收 (百万美元)
2000: $374  ████
2001: $735  ████████
2002: $1,045 ███████████
2003: $1,346 ██████████████
2004: $1,824 ███████████████████
2005: $2,376 ████████████████████████
```

### 9.2 研发投入分析

#### R&D支出占比
- 2000年：18% ($67M)
- 2002年：21% ($219M)
- 2004年：24% ($437M)
- 2005年：26% ($617M)

### 9.3 专利战略

#### 专利申请统计
```
年度专利申请数
2000-2002: 156件 (基础图形技术)
2003-2004: 248件 (着色器相关)
2005: 186件 (系统架构)
```

## 10. 产业影响与技术遗产

### 10.1 对游戏产业的推动

#### 里程碑游戏技术
- **Doom 3** (2004)：全面动态光影
- **Half-Life 2** (2004)：物理渲染结合
- **Far Cry** (2004)：大规模植被渲染
- **F.E.A.R.** (2005)：软阴影技术

### 10.2 专业市场拓展

#### Quadro产品线演进
```
Quadro专业卡定位
├── CAD/CAM: 精确渲染
├── DCC: 实时预览
├── 医疗成像: 高精度显示
└── 科学可视化: 大数据渲染
```

### 10.3 技术标准制定

#### 标准组织参与
- **OpenGL ARB**：架构审查委员会成员
- **DirectX咨询**：微软技术合作伙伴
- **PCI-SIG**：PCIe标准制定参与

## 关键人物访谈摘录

### David Kirk (首席科学家)
> "可编程性不仅仅是一个功能，它代表着GPU从固定功能加速器向通用处理器演进的开始。我们在2001年种下的种子，将在CUDA中开花结果。"

### Curtis Priem (联合创始人)
> "收购3dfx是一个艰难但必要的决定。我们获得的不仅是技术，更是一支经历过激烈竞争的团队。"

### Tony Tamasi (高级副总裁)
> "GeForce FX的失败教会我们，光有先进的架构是不够的，执行力和工程优化同样重要。"

## 本章总结

2000-2005年是GPU发展史上的黄金时代。NVIDIA通过一系列关键决策——收购3dfx获得关键技术、推出可编程着色器引领技术革命、进入Xbox主机市场、复活SLI技术——不仅在技术上完成了从固定管线到可编程架构的跨越，更在商业上奠定了市场领导地位。

尽管期间经历了GeForce FX的重大挫折，但NVIDIA展现出的技术韧性和快速纠错能力，以及对开发者生态的持续投入，为其后续在CUDA计算时代的爆发奠定了坚实基础。这个时期培养的可编程思维、统一架构理念、以及软件生态重视，都成为NVIDIA区别于竞争对手的核心优势。

最重要的是，这五年间NVIDIA意识到：GPU的未来不仅仅是图形，而是一个更广阔的并行计算平台。这个认知的转变，将在下一个五年彻底改变整个计算产业的格局。

---

[上一章：创世纪 (1993-1999)](chapter1.md) | [目录](index.md) | [下一章：统一架构革命 (2006-2009)](chapter3.md)